# -*- coding: UTF-8 -*-

import requests
import lxml
import time
import re
from bs4 import BeautifulSoup
from aip import AipOcr
from PIL import Image, ImageGrab


search_url_2 = 'http://news.baidu.com/ns?ct=1&rn=20&ie=utf-8&rsv_bp=1&sr=0&cl=2&f=8&prevct=no&tn=news&word={keywords}'
search_url_1 = 'https://www.baidu.com/s?wd={keywords}&pn=10&rn=50'


headers = {
    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.104 Safari/537.36 Core/1.53.4399.400 QQBrowser/9.7.12777.400'
}

def search_1(work):
    url = search_url_1.format(keywords=work.get('title'))
    response = requests.get(url, headers=headers)
    soup = BeautifulSoup(response.text, 'lxml')
    answer = soup.select('.c-abstract')
    answer1 = [x.text for x in answer]

    x = 0
    y = 0
    z = 0
    tt = {'an_1': x, 'an_2': y, 'an_3': z}
    for a in answer1:
        if work.get('A') in a:
            tt['an_1'] += 1
        elif work.get('B') in a:
            tt['an_2'] += 1
        elif work.get('C') in a:
            tt['an_3'] += 1

    tips = 'A出现次数为{}，B出现次数为{}，C出现次数为{}。\n建议你选最大值的选项！'.format(
        tt['an_1'], tt['an_2'], tt['an_3'])
    print(tips)


def search_2(work):

    r = []
    if '没有' in work.get('title'):
        print('*****此道题中含有"不,没有"， 所以注意选择^相反^的选项：')
    elif '不' in work.get('title'):
        print('*****此道题中含有"不,没有"， 所以注意选择^相反^的选项：')

    for tt in [work.get('A'), work.get('B'), work.get('C')]:
        url = search_url_2.format(keywords=work.get('title') + tt)
        # print(url)
        response = requests.get(url, headers=headers)
        soup = BeautifulSoup(response.text, 'lxml')
        answer = soup.select('.nums')[0]
        r.append(answer.text)
    result = 'A:{},\nB:{},\nC:{},\n'.format(r[0], r[1], r[2])
    print(result)
    return result
